<!DOCTYPE html>
<html lang="en">

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
 
  ga('create', 'UA-79921848-1', 'auto');
  ga('send', 'pageview');
 
</script>

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="sistenix.com - Binary Logarithm Algorithm">
    <meta name="keywords" content="hardware, design, VLSI, logarithm, algorithm, amba, digital signal processing, SystemVerilog">
    <meta name="author" content="Nelson Campos">
	
	
    <link rel="shortcut icon" href="img/icone2.ico" />
    <title>Logarithm Computation</title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/clean-blog.min.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="index.html">Nelson Campos</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="index.html">Home</a>
                    </li>
                    <li>
                        <a href="about.html">About</a>
                    </li>
                    <li>
                        <a href="peasant.html">Peasant</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header class="intro-header" style="background-image: url('img/post-bg2.jpg')">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>Binary Logarithm</h1>
                        <h2 class="subheading">SystemVerilog implementation of the Hardware Algorithm</h2>
                        <span class="meta">Posted by <a href="about.html">Nelson Campos</a> on August 02, 2016</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Post Content -->
    <article>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <p>The logarithm operation is widely used in digital signal processing. There are many scientific applications that requieres logarithm computations and since it is computer expensive a hardware implementation may be used for acceleration purposes. </p>
                    <p>An algorithm for the base 2 logarithm can be seen in [1].</p> 
					<p>A binary logarithm may be defined according to equation (1):</p>
                    <a href="img/log_eq1.svg">
                        <img class="img-responsive center-block" src="img/log_eq1.svg" alt="">
                    </a>
					<span class="caption text-muted">equation (1)</span>
					
					<p>Inverting the equation (1) the equation (2) is obtained:</p>
                    
					<a href="img/log_eq2.svg">
                        <img class="img-responsive center-block" src="img/log_eq2.svg" alt="">
                    </a>
					<span class="caption text-muted">equation (2)</span>
					
					<p><i>y</i> may be represented in the binary form as can be seen in equation (3):</p>
                    <a href="img/log_eq3.svg">
                        <img class="img-responsive center-block" src="img/log_eq3.svg" alt="">
                    </a>
					<span class="caption text-muted">equation (3)</span>
					
					<p>Putting equation (3) into equation (2) the equation (4) is obtained as follows:</p>
                    
					<a href="img/log_eq4.svg">
                        <img class="img-responsive center-block" src="img/log_eq4.svg" alt="">
                    </a>
					<span class="caption text-muted">equation (4)</span>
					
					<p>From equations (3) and (4) can be inferred that the maximum value of <i>y</i> is 1 (the sum of a geometric progression with common ratio 0.5 when all bits of <i>y</i> is 1) and consequently the maximum value of <i>x</i> is 2.</p>
					
					<p>Squaring equation (4) gives the equation (5) as can be seen below:</p>
					<a href="img/log_eq5.svg">
                        <img class="img-responsive center-block" src="img/log_eq5.svg" alt="">
                    </a>
					<span class="caption text-muted">equation (5)</span>
					<p>An analysis of equation (5) states that the value of <i>x<sup>2</sup></i> can be expressed in two cases:</p>
					<a href="img/log_eq6.svg">
                        <img class="img-responsive center-block" src="img/log_eq6.svg" alt="">
                    </a>
					<span class="caption text-muted">equation (6)</span>
					

					<p>According to equation (6) if the value <i>x<sup>2</sup> >2</i>, then the <i>i-th</i> bit of <i>y<sub>i</sub></i> is 1  at the <i>i-th</i> iteration and <i>x</i> should be divided by 2, otherwise, if <i>x<sup>2</sup><=2</i>, <i>y<sub>i</sub>=0</i>.</p>
                    <p>Since the binary algorithm works for 0<=<i>x</i><=1, if <i>x</i> is greater than 1, <i>x</i> should be scaled as can be seen below:</p>
					
					<a href="img/log_eq7.svg">
                        <img class="img-responsive center-block" src="img/log_eq7.svg" alt="">
                    </a>
					<span class="caption text-muted">equation (7)</span>
					
					<h2 class="section-heading"> Example: calculating <i>log<sub>2</sub>(pi)</i> </h2>
					
					<p>To illustrate the algorithm, the calculation of the logarithm of <i>log2(pi)</i> (<i>pi</i> is approximately 3.140625), <i>pi</i> is scaled according to table 1.</p>
					
                    <!-- Begin of table -->
					<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
.tg .tg-yw4l{vertical-align:top}
</style>
<table class="tg" align="center">
  <tr>
    <th class="tg-031e">x</th>
    <th class="tg-031e">k</th>
    <th class="tg-yw4l">x scaled</th>
  </tr>
  <tr>
    <td class="tg-031e">3.140625</td>
    <td class="tg-031e">1</td>
    <td class="tg-yw4l">1.5703125</td>
  </tr>
</table>
<span class="caption text-muted">table (1)</span>
<!-- End of table -->

<p>The value k is the integer part of the logarithm. Now the scaled value of <i>x</i> will be computed using the algorithm. Table (2) gives the result of the scaled x using 7 bits of precision.</p>
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
.tg .tg-yw4l{vertical-align:top}
</style>
<table class="tg" align="center">
  <tr>
    <th class="tg-031e">i</th>
    <th class="tg-031e">x</th>
    <th class="tg-031e">x^2</th>
    <th class="tg-031e">x^2&gt;2</th>
    <th class="tg-031e">y</th>
  </tr>
  <tr>
    <td class="tg-031e">6</td>
    <td class="tg-031e">1.5707</td>
    <td class="tg-031e">2.46</td>
    <td class="tg-031e">yes</td>
    <td class="tg-031e">1</td>
  </tr>
  <tr>
    <td class="tg-031e">5</td>
    <td class="tg-031e">1.23</td>
    <td class="tg-031e">1.51</td>
    <td class="tg-031e">no</td>
    <td class="tg-031e">0</td>
  </tr>
  <tr>
    <td class="tg-031e">4</td>
    <td class="tg-031e">1.51</td>
    <td class="tg-031e">2.28</td>
    <td class="tg-031e">yes</td>
    <td class="tg-031e">1</td>
  </tr>
  <tr>
    <td class="tg-031e">3</td>
    <td class="tg-031e">1.14</td>
    <td class="tg-031e">1.29</td>
    <td class="tg-031e">no</td>
    <td class="tg-031e">0</td>
  </tr>
  <tr>
    <td class="tg-031e">2</td>
    <td class="tg-031e">1.29</td>
    <td class="tg-031e">1.69</td>
    <td class="tg-031e">no</td>
    <td class="tg-031e">0</td>
  </tr>
  <tr>
    <td class="tg-yw4l">1</td>
    <td class="tg-yw4l">1.69</td>
    <td class="tg-yw4l">2.86</td>
    <td class="tg-yw4l">yes</td>
    <td class="tg-yw4l">1</td>
  </tr>
  <tr>
    <td class="tg-yw4l">0</td>
    <td class="tg-yw4l">1.43</td>
    <td class="tg-yw4l">2.04</td>
    <td class="tg-yw4l">yes</td>
    <td class="tg-yw4l">1</td>
  </tr>
</table>
<span class="caption text-muted">table (2)</span>

<p> The value of <i>y = (0.1010011)<sub>2</sub> = 0.6484375</i> is the fractional part of the logarithm. Then, the approximate value of <i>log2(pi)</i> is k+y = 1.6484375</p>

<p>The flowchart of the logarithm algorithm can be seen in Figure (1). The square operation of <i>x</i> may be computed using the <a href="peasant.html">Peasant Multiplication</a>.</p>
                    <a href="img/loga.svg">
                        <img class="img-responsive center-block" src="img/loga.svg" alt="">
                    </a>
					<span class="caption text-muted">Figure (1): The Logarithm Algorithm</span>
					
					
<p>You want to practice? Check out the SystemVerilog implementation of Logarithm module and its testbench:</p>

<!-- HTML generated using hilite.me --><div style="background: #f8f8f8; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #008000; font-weight: bold">module</span> <span style="color: #880000">LOG</span> #(<span style="color: #008000; font-weight: bold">parameter</span> <span style="color: #880000">M</span><span style="color: #666666">=4</span>,
                       <span style="color: #880000">N</span><span style="color: #666666">=10</span>) 
            (<span style="color: #008000; font-weight: bold">output</span> <span style="color: #008000; font-weight: bold">logic</span> [<span style="color: #880000">M</span><span style="color: #666666">+</span><span style="color: #A0A000">N:</span> <span style="color: #666666">0</span>] logNumber,
             <span style="color: #008000; font-weight: bold">output</span> <span style="color: #008000; font-weight: bold">logic</span> iReady, oValid, 
             <span style="color: #008000; font-weight: bold">input</span> <span style="color: #008000; font-weight: bold">logic</span> [<span style="color: #880000">M</span><span style="color: #666666">+</span><span style="color: #A0A000">N:</span> <span style="color: #666666">0</span>] number, 
             <span style="color: #008000; font-weight: bold">input</span> <span style="color: #008000; font-weight: bold">logic</span> reset, clock, oReady, iValid
             );
    
    <span style="color: #008000; font-weight: bold">logic</span> <span style="color: #008000; font-weight: bold">signed</span> [<span style="color: #880000">M</span><span style="color: #666666">+</span><span style="color: #A0A000">N:</span> <span style="color: #666666">0</span>] floorNumber, index;
    <span style="color: #008000; font-weight: bold">logic</span> [<span style="color: #880000">M</span><span style="color: #666666">+</span><span style="color: #880000">M</span><span style="color: #666666">+</span><span style="color: #880000">N</span><span style="color: #666666">+</span><span style="color: #A0A000">N:</span><span style="color: #666666">0</span>] x, a, b; 
    <span style="color: #008000; font-weight: bold">logic</span> [<span style="color: #666666">5:0</span>] count;
    <span style="color: #008000; font-weight: bold">enum</span> <span style="color: #008000; font-weight: bold">logic</span> [<span style="color: #666666">2:0</span>] {<span style="color: #880000">INIT</span>,<span style="color: #880000">WAIT_AND_PREPARE</span>,<span style="color: #880000">SCALE</span>,<span style="color: #880000">PEASANT_PREP</span>,<span style="color: #880000">PEASANT</span>,<span style="color: #880000">CALC</span>,<span style="color: #880000">SEND</span>} state;
    
    <span style="color: #008000; font-weight: bold">always_ff</span> @(<span style="color: #008000; font-weight: bold">posedge</span> clock)
        <span style="color: #008000; font-weight: bold">if</span>(reset) <span style="color: #008000; font-weight: bold">begin</span>
            iReady <span style="color: #666666">&lt;=</span> <span style="color: #666666">0</span>;
            logNumber <span style="color: #666666">&lt;=</span> <span style="color: #666666">&#39;x</span>;
            oValid <span style="color: #666666">&lt;=</span> <span style="color: #666666">0</span>;
            state <span style="color: #666666">&lt;=</span> <span style="color: #880000">INIT</span>;
        <span style="color: #008000; font-weight: bold">end</span>
        <span style="color: #008000; font-weight: bold">else</span> <span style="color: #008000; font-weight: bold">case</span>(state)
                <span style="color: #A0A000">INIT:</span> <span style="color: #008000; font-weight: bold">begin</span>
                    logNumber <span style="color: #666666">&lt;=</span> <span style="color: #666666">&#39;0</span>;
                    iReady <span style="color: #666666">&lt;=</span> <span style="color: #666666">1</span>;
                    oValid <span style="color: #666666">&lt;=</span> <span style="color: #666666">0</span>;
                    count <span style="color: #666666">&lt;=</span> <span style="color: #880000">N</span><span style="color: #666666">-1</span>;
                    index <span style="color: #666666">&lt;=</span> <span style="color: #666666">0</span>;
                    state <span style="color: #666666">&lt;=</span> <span style="color: #880000">WAIT_AND_PREPARE</span>;
                <span style="color: #008000; font-weight: bold">end</span>
                
                <span style="color: #A0A000">WAIT_AND_PREPARE:</span> <span style="color: #008000; font-weight: bold">begin</span>
                    <span style="color: #008000; font-weight: bold">if</span>(iValid) <span style="color: #008000; font-weight: bold">begin</span>
                        iReady <span style="color: #666666">&lt;=</span> <span style="color: #666666">0</span>;
                        x <span style="color: #666666">&lt;=</span> number; 
                        state <span style="color: #666666">&lt;=</span> <span style="color: #880000">SCALE</span>;
                    <span style="color: #008000; font-weight: bold">end</span>
                    <span style="color: #008000; font-weight: bold">else</span> <span style="color: #008000; font-weight: bold">begin</span>
                        state <span style="color: #666666">&lt;=</span> <span style="color: #880000">WAIT_AND_PREPARE</span>;
                    <span style="color: #008000; font-weight: bold">end</span>
                <span style="color: #008000; font-weight: bold">end</span>
                
                <span style="color: #A0A000">SCALE:</span> <span style="color: #008000; font-weight: bold">begin</span>
                    <span style="color: #008000; font-weight: bold">if</span>((x<span style="color: #666666">&gt;&gt;</span><span style="color: #880000">N</span>) <span style="color: #666666">&gt;</span> <span style="color: #666666">1</span>) <span style="color: #008000; font-weight: bold">begin</span>
                        x <span style="color: #666666">&lt;=</span> x <span style="color: #666666">&gt;&gt;</span> <span style="color: #666666">1</span>;
                        index <span style="color: #666666">&lt;=</span> index<span style="color: #666666">+1</span>;
                    <span style="color: #008000; font-weight: bold">end</span>
                    <span style="color: #008000; font-weight: bold">else</span> <span style="color: #008000; font-weight: bold">if</span>(<span style="color: #666666">!</span>(x<span style="color: #666666">&gt;&gt;</span><span style="color: #880000">N</span>)) <span style="color: #008000; font-weight: bold">begin</span>
                        x <span style="color: #666666">&lt;=</span> x <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">1</span>;
                        index <span style="color: #666666">&lt;=</span> index<span style="color: #666666">-1</span>;
                    <span style="color: #008000; font-weight: bold">end</span>
                    <span style="color: #008000; font-weight: bold">else</span> <span style="color: #008000; font-weight: bold">begin</span>
                        index <span style="color: #666666">&lt;=</span> index<span style="color: #666666">&lt;&lt;&lt;</span><span style="color: #880000">N</span>; 
                        state <span style="color: #666666">&lt;=</span> <span style="color: #880000">PEASANT_PREP</span>;                     
                    <span style="color: #008000; font-weight: bold">end</span>
                <span style="color: #008000; font-weight: bold">end</span>
                
                <span style="color: #A0A000">PEASANT_PREP:</span> <span style="color: #008000; font-weight: bold">begin</span>
                    a <span style="color: #666666">&lt;=</span> x;
                    b <span style="color: #666666">&lt;=</span> x;
                    x <span style="color: #666666">&lt;=</span> <span style="color: #666666">0</span>;
                    state <span style="color: #666666">&lt;=</span> <span style="color: #880000">PEASANT</span>;
                <span style="color: #008000; font-weight: bold">end</span>
                
                <span style="color: #A0A000">PEASANT:</span> <span style="color: #008000; font-weight: bold">begin</span>
                    <span style="color: #008000; font-weight: bold">if</span>(a<span style="color: #666666">&gt;=1</span>) <span style="color: #008000; font-weight: bold">begin</span>
                        x <span style="color: #666666">&lt;=</span> (a[<span style="color: #666666">0</span>])<span style="color: #666666">?</span>(x<span style="color: #666666">+</span>b)<span style="color: #666666">:</span>x;
                        a <span style="color: #666666">&lt;=</span> a <span style="color: #666666">&gt;&gt;</span> <span style="color: #666666">1</span>;
                        b <span style="color: #666666">&lt;=</span> b <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">1</span>;
                    <span style="color: #008000; font-weight: bold">end</span>
                    <span style="color: #008000; font-weight: bold">else</span> <span style="color: #008000; font-weight: bold">begin</span>
                        x <span style="color: #666666">&lt;=</span> x<span style="color: #666666">&gt;&gt;</span><span style="color: #880000">N</span>; 
                        state <span style="color: #666666">&lt;=</span> <span style="color: #880000">CALC</span>;
                    <span style="color: #008000; font-weight: bold">end</span>
                <span style="color: #008000; font-weight: bold">end</span>
                
                <span style="color: #A0A000">CALC:</span> <span style="color: #008000; font-weight: bold">begin</span>
                  <span style="color: #008000; font-weight: bold">if</span>(count<span style="color: #666666">&lt;=</span><span style="color: #880000">N</span><span style="color: #666666">-1</span>) <span style="color: #008000; font-weight: bold">begin</span>
                        <span style="color: #008000; font-weight: bold">if</span>((x<span style="color: #666666">&gt;&gt;</span><span style="color: #880000">N</span>) <span style="color: #666666">&gt;=</span> <span style="color: #666666">2</span>) <span style="color: #008000; font-weight: bold">begin</span>
                            logNumber[count] <span style="color: #666666">&lt;=</span> <span style="color: #666666">1</span>;
                            x <span style="color: #666666">&lt;=</span> x<span style="color: #666666">&gt;&gt;1</span>;
                        <span style="color: #008000; font-weight: bold">end</span>
                        <span style="color: #008000; font-weight: bold">else</span> logNumber[count] <span style="color: #666666">&lt;=</span> <span style="color: #666666">0</span>;
                        
                        count <span style="color: #666666">&lt;=</span> count<span style="color: #666666">-1</span>;
                        state <span style="color: #666666">&lt;=</span> <span style="color: #880000">PEASANT_PREP</span>;
                    <span style="color: #008000; font-weight: bold">end</span>
                    <span style="color: #008000; font-weight: bold">else</span> <span style="color: #008000; font-weight: bold">begin</span> 
                        state <span style="color: #666666">&lt;=</span> <span style="color: #880000">SEND</span>;
                        logNumber <span style="color: #666666">&lt;=</span> index<span style="color: #666666">+</span>logNumber;
                        oValid <span style="color: #666666">&lt;=</span> <span style="color: #666666">1</span>;
                    <span style="color: #008000; font-weight: bold">end</span>
                <span style="color: #008000; font-weight: bold">end</span>
                
                <span style="color: #A0A000">SEND:</span> <span style="color: #008000; font-weight: bold">begin</span>
                    <span style="color: #008000; font-weight: bold">if</span>(oReady) <span style="color: #008000; font-weight: bold">begin</span>
                        oValid <span style="color: #666666">&lt;=</span> <span style="color: #666666">0</span>;
                        state <span style="color: #666666">&lt;=</span> <span style="color: #880000">INIT</span>;
                    <span style="color: #008000; font-weight: bold">end</span>
                    <span style="color: #008000; font-weight: bold">else</span> state <span style="color: #666666">&lt;=</span> <span style="color: #880000">SEND</span>;
                <span style="color: #008000; font-weight: bold">end</span>
        <span style="color: #008000; font-weight: bold">endcase</span>
<span style="color: #008000; font-weight: bold">endmodule</span><span style="color: #666666">:</span> <span style="color: #880000">LOG</span>
</pre></div>

<span class="caption text-muted">SystemVerilog code for Logarithm Algorithm</span>

<!-- HTML generated using hilite.me --><div style="background: #f8f8f8; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #880000">`include</span> <span style="color: #BA2121">&quot;log2.sv&quot;</span>

<span style="color: #008000; font-weight: bold">parameter</span> <span style="color: #880000">M</span> <span style="color: #666666">=</span> <span style="color: #666666">4</span>;
<span style="color: #008000; font-weight: bold">parameter</span> <span style="color: #880000">N</span> <span style="color: #666666">=</span> <span style="color: #666666">10</span>;

<span style="color: #008000; font-weight: bold">module</span> top;
    <span style="color: #008000; font-weight: bold">logic</span> clock;
    <span style="color: #008000; font-weight: bold">logic</span> reset;
    <span style="color: #008000; font-weight: bold">logic</span> iReady, iValid, oReady, oValid;
    
    <span style="color: #008000; font-weight: bold">logic</span> <span style="color: #008000; font-weight: bold">signed</span> [<span style="color: #880000">M</span><span style="color: #666666">+</span><span style="color: #A0A000">N:</span> <span style="color: #666666">0</span>] number, logNumber;
    
    <span style="color: #008000; font-weight: bold">enum</span> <span style="color: #008000; font-weight: bold">logic</span> {<span style="color: #880000">S1</span>,<span style="color: #880000">S2</span>} state;
    
    <span style="color: #008000; font-weight: bold">initial</span> <span style="color: #008000; font-weight: bold">begin</span>
        clock <span style="color: #666666">=</span> <span style="color: #666666">0</span>;
        reset <span style="color: #666666">=</span> <span style="color: #666666">1</span>;
        #<span style="color: #666666">22</span> reset <span style="color: #666666">=</span> <span style="color: #666666">0</span>;
    <span style="color: #008000; font-weight: bold">end</span>

    <span style="color: #008000; font-weight: bold">always</span> #<span style="color: #666666">5</span> clock <span style="color: #666666">=</span> <span style="color: #666666">!</span>clock;

    <span style="color: #880000">LOG</span>#(<span style="color: #880000">M</span>,<span style="color: #880000">N</span>) myLog(.<span style="color: #666666">*</span>);
    
    <span style="color: #008000; font-weight: bold">always_ff</span> @(<span style="color: #008000; font-weight: bold">posedge</span> clock) <span style="color: #008000; font-weight: bold">begin</span>
        <span style="color: #008000; font-weight: bold">if</span>(reset) <span style="color: #008000; font-weight: bold">begin</span>
            iValid <span style="color: #666666">&lt;=</span> <span style="color: #666666">0</span>;
            state <span style="color: #666666">&lt;=</span> <span style="color: #880000">S1</span>;
            oReady <span style="color: #666666">&lt;=</span> <span style="color: #666666">0</span>;
        <span style="color: #008000; font-weight: bold">end</span>
        <span style="color: #008000; font-weight: bold">else</span> <span style="color: #008000; font-weight: bold">case</span>(state)
            <span style="color: #A0A000">S1:</span> <span style="color: #008000; font-weight: bold">begin</span>
                number <span style="color: #666666">&lt;=</span> <span style="color: #666666">15&#39;b00011</span>_0010010000;
                iValid <span style="color: #666666">&lt;=</span> <span style="color: #666666">1</span>;
                <span style="color: #008000; font-weight: bold">if</span>(iReady)
                    state <span style="color: #666666">&lt;=</span> <span style="color: #880000">S2</span>;
                    oReady <span style="color: #666666">&lt;=</span> <span style="color: #666666">1</span>;
            <span style="color: #008000; font-weight: bold">end</span>
            <span style="color: #A0A000">S2:</span> 
                <span style="color: #008000; font-weight: bold">if</span>(oValid) <span style="color: #008000; font-weight: bold">begin</span>
                    <span style="color: #008000; font-weight: bold">if</span>(logNumber[<span style="color: #880000">M</span><span style="color: #666666">+</span><span style="color: #880000">N</span>])
                        <span style="color: #008000">$display</span>(<span style="color: #BA2121">&quot;%b&quot;</span>, (<span style="color: #666666">~</span>logNumber<span style="color: #666666">+15&#39;d1</span>));
                    <span style="color: #008000; font-weight: bold">else</span>
                        <span style="color: #008000">$display</span>(<span style="color: #BA2121">&quot;%b&quot;</span>, logNumber);
                        
                    <span style="border: 1px solid #FF0000">$</span>finish();
                <span style="color: #008000; font-weight: bold">end</span>
        <span style="color: #008000; font-weight: bold">endcase</span>
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">endmodule</span>
</pre></div>

<span class="caption text-muted">SystemVerilog code for Logarithm testbench</span>


<p>References: [1] <a href="http://www.claysturner.com/dsp/binarylogarithm.pdf">A Fast Binary Logarithm Algorithm</a> </p>
<p>Also available in <a href="https://github.com/nelsoncsc/sv_math/tree/master/log">GitHub</a>. </p>
                </div>
            </div>
        </div>
    </article>

    <hr>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <ul class="list-inline text-center">
                        <li>
                            <a href="mailto:nelsoncscampos@gmail.com">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="https://br.linkedin.com/in/nelsoncsc">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-circle fa-linkedin-color fa-stack-2x stacked-line-height"></i>
                                    <i class="fa fa-linkedin fa-stack-1x fa-inverse stacked-line-height-2"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="https://github.com/nelsoncsc">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    </ul>
                    <p class="copyright text-muted">Copyright &copy; sistenix.com 2016</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="js/clean-blog.min.js"></script>

</body>

</html>
